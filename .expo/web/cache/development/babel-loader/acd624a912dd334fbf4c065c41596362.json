{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\kenwy\\\\Desktop\\\\React Native\\\\signal-clone\\\\screens\\\\ChatScreen.js\";\n\nimport React, { useLayoutEffect, useState } from 'react';\nimport { StatusBar } from 'expo-status-bar';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport { Avatar } from 'react-native-elements';\nimport { AntDesign, FontAwesome, Ionicons } from '@expo/vector-icons';\nimport { db, auth } from \"../firebaseConfig\";\nimport firebase from 'firebase/app';\nimport \"firebase/firestore\";\n\nvar ChatScreen = function ChatScreen(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      input = _useState2[0],\n      setInput = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: \"Chat\",\n      headerBackTitleVisible: false,\n      headerTitleAlign: \"left\",\n      headerTitle: function headerTitle() {\n        var _messages$;\n\n        return React.createElement(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\",\n            marginLeft: -20\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 21,\n            columnNumber: 17\n          }\n        }, React.createElement(Avatar, {\n          rounded: true,\n          source: {\n            uri: (_messages$ = messages[0]) == null ? void 0 : _messages$.data.photoURL\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 26,\n            columnNumber: 21\n          }\n        }), React.createElement(Text, {\n          style: {\n            color: \"white\",\n            fontWeight: \"700\",\n            marginLeft: 10,\n            fontSize: 15,\n            textAlign: 'center'\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 27,\n            columnNumber: 21\n          }\n        }, route.params.chatName));\n      },\n      headerRight: function headerRight() {\n        return React.createElement(View, {\n          style: {\n            flexDirection: \"row\",\n            justifyContent: \"space-between\",\n            marginRight: 20,\n            width: 80\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 31,\n            columnNumber: 17\n          }\n        }, React.createElement(TouchableOpacity, {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 21\n          }\n        }, React.createElement(FontAwesome, {\n          name: \"video-camera\",\n          size: 24,\n          color: \"white\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 25\n          }\n        })), React.createElement(TouchableOpacity, {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 40,\n            columnNumber: 21\n          }\n        }, React.createElement(Ionicons, {\n          name: \"call\",\n          size: 24,\n          color: \"white\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 25\n          }\n        })));\n      }\n    });\n  }, [navigation]);\n\n  var sendMessage = function sendMessage() {\n    Keyboard.dismiss();\n    db.collection('chats').doc(route.params.id).collection(\"messages\").add({\n      timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n      message: input,\n      displayName: auth.currentUser.displayName,\n      email: auth.currentUser.email,\n      photoURL: auth.currentUser.photoURL\n    });\n    setInput('');\n  };\n\n  useLayoutEffect(function () {\n    var unsubscribe = db.collection(\"chats\").doc(route.params.id).collection(\"messages\").orderBy(\"timestamp\", \"desc\").onSnapshot(function (snapshot) {\n      return setMessages(snapshot.docs.map(function (doc) {\n        return {\n          id: doc.id,\n          data: doc.data()\n        };\n      }));\n    });\n    return unsubscribe;\n  }, [route]);\n  return React.createElement(SafeAreaView, {\n    style: {\n      flex: 1,\n      backgroundColor: \"f9f9f9\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, React.createElement(StatusBar, {\n    style: \"dark\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }), React.createElement(KeyboardAvoidingView, {\n    behavior: Platform.OS === \"ios\" ? \"padding\" : \"height\",\n    style: styles.container,\n    keyboardVerticalOffset: 90,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, React.createElement(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 17\n    }\n  }, React.createElement(React.Fragment, null, React.createElement(ScrollView, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 21\n    }\n  }, messages.map(function (_ref2) {\n    var id = _ref2.id,\n        data = _ref2.data;\n    return data.email === auth.currentUser.email ? React.createElement(View, {\n      key: id,\n      style: styles.reciever,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 31\n      }\n    }, React.createElement(Avatar, {\n      position: \"absolute\",\n      right: -5,\n      bottom: -15,\n      rounded: true,\n      size: 30,\n      source: {\n        uri: data.photoURL\n      },\n      containerStyle: styles.avatarReciever,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 35\n      }\n    }), React.createElement(Text, {\n      style: styles.recieverText,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 35\n      }\n    }, data.message), React.createElement(Text, {\n      style: styles.recieverName,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 35\n      }\n    }, data.displayName)) : React.createElement(View, {\n      style: styles.sender,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 33\n      }\n    }, React.createElement(Avatar, {\n      position: \"absolute\",\n      left: -5,\n      bottom: -15,\n      rounded: true,\n      size: 30,\n      source: {\n        uri: data.photoURL\n      },\n      containerStyle: styles.avatarSender,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 37\n      }\n    }), React.createElement(Text, {\n      style: styles.senderText,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 35\n      }\n    }, data.message), React.createElement(Text, {\n      style: styles.senderName,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 35\n      }\n    }, data.displayName));\n  })), React.createElement(View, {\n    style: styles.footer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }, React.createElement(TextInput, {\n    value: input,\n    onChangeText: function onChangeText(text) {\n      return setInput(text);\n    },\n    onSubmitEditing: sendMessage,\n    placeholder: \"Type Message...\",\n    style: styles.textInput,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: sendMessage,\n    activeOpacity: 0.5,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 25\n    }\n  }, React.createElement(Ionicons, {\n    name: \"send\",\n    size: 24,\n    color: \"#0b3c6e\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 29\n    }\n  })))))));\n};\n\nexport default ChatScreen;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 5\n  },\n  reciever: {\n    padding: 15,\n    backgroundColor: \"#ababab\",\n    alignSelf: \"flex-end\",\n    borderRadius: 20,\n    marginRight: 15,\n    marginBottom: 20,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  sender: {\n    padding: 15,\n    backgroundColor: \"#2B68E6\",\n    alignSelf: \"flex-start\",\n    borderRadius: 20,\n    margin: 15,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  avatarReciever: {\n    position: \"absolute\",\n    bottom: -15,\n    right: -5\n  },\n  avatarSender: {\n    position: \"absolute\",\n    bottom: -15,\n    left: -5\n  },\n  recieverText: {\n    color: \"black\",\n    fontWeight: \"400\",\n    marginRight: 10,\n    marginBottom: 10\n  },\n  senderText: {\n    color: \"white\",\n    fontWeight: \"400\",\n    marginLeft: 10,\n    marginBottom: 10\n  },\n  recieverName: {\n    position: \"absolute\",\n    bottom: 2,\n    right: 27,\n    fontSize: 10,\n    color: \"black\"\n  },\n  senderName: {\n    position: \"absolute\",\n    bottom: 2,\n    left: 27,\n    fontSize: 10,\n    color: \"white\"\n  },\n  footer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    width: \"100%\",\n    padding: 10\n  },\n  textInput: {\n    flex: 1,\n    bottom: 0,\n    height: 40,\n    marginRight: 10,\n    borderColor: \"black\",\n    backgroundColor: \"#ECECEC\",\n    borderWidth: 1,\n    padding: 5,\n    color: \"black\",\n    borderRadius: 30,\n    width: \"100%\"\n  }\n});","map":{"version":3,"sources":["C:/Users/kenwy/Desktop/React Native/signal-clone/screens/ChatScreen.js"],"names":["React","useLayoutEffect","useState","StatusBar","Avatar","AntDesign","FontAwesome","Ionicons","db","auth","firebase","ChatScreen","navigation","route","input","setInput","messages","setMessages","setOptions","title","headerBackTitleVisible","headerTitleAlign","headerTitle","flexDirection","alignItems","marginLeft","uri","data","photoURL","color","fontWeight","fontSize","textAlign","params","chatName","headerRight","justifyContent","marginRight","width","sendMessage","Keyboard","dismiss","collection","doc","id","add","timestamp","firestore","FieldValue","serverTimestamp","message","displayName","currentUser","email","unsubscribe","orderBy","onSnapshot","snapshot","docs","map","flex","backgroundColor","Platform","OS","styles","container","reciever","avatarReciever","recieverText","recieverName","sender","avatarSender","senderText","senderName","footer","text","textInput","StyleSheet","create","marginTop","padding","alignSelf","borderRadius","marginBottom","maxWidth","position","margin","bottom","right","left","height","borderColor","borderWidth"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAeC,eAAf,EAAgCC,QAAhC,QAA+C,OAA/C;AACA,SAASC,SAAT,QAA0B,iBAA1B;;;;;;;;;;;;AAEA,SAASC,MAAT,QAAuB,uBAAvB;AACA,SAASC,SAAT,EAAoBC,WAApB,EAAiCC,QAAjC,QAAiD,oBAAjD;AACA,SAASC,EAAT,EAAaC,IAAb;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAQ,oBAAR;;AAGA,IAAMC,UAAU,GAAG,SAAbA,UAAa,OAA0B;AAAA,MAAxBC,UAAwB,QAAxBA,UAAwB;AAAA,MAAZC,KAAY,QAAZA,KAAY;;AAEzC,kBAA0BX,QAAQ,CAAC,EAAD,CAAlC;AAAA;AAAA,MAAOY,KAAP;AAAA,MAAcC,QAAd;;AACA,mBAAgCb,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAOc,QAAP;AAAA,MAAiBC,WAAjB;;AACAhB,EAAAA,eAAe,CAAC,YAAM;AAClBW,IAAAA,UAAU,CAACM,UAAX,CAAsB;AAClBC,MAAAA,KAAK,EAAE,MADW;AAElBC,MAAAA,sBAAsB,EAAE,KAFN;AAGlBC,MAAAA,gBAAgB,EAAE,MAHA;AAIlBC,MAAAA,WAAW,EAAE;AAAA;;AAAA,eACT,oBAAC,IAAD;AAAM,UAAA,KAAK,EAAE;AACTC,YAAAA,aAAa,EAAC,KADL;AAETC,YAAAA,UAAU,EAAC,QAFF;AAGTC,YAAAA,UAAU,EAAC,CAAC;AAHH,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAKI,oBAAC,MAAD;AAAQ,UAAA,OAAO,MAAf;AAAgB,UAAA,MAAM,EAAE;AAAEC,YAAAA,GAAG,gBAAEV,QAAQ,CAAC,CAAD,CAAV,qBAAE,WAAaW,IAAb,CAAkBC;AAAzB,WAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UALJ,EAMI,oBAAC,IAAD;AAAM,UAAA,KAAK,EAAE;AAACC,YAAAA,KAAK,EAAC,OAAP;AAAgBC,YAAAA,UAAU,EAAC,KAA3B;AAAkCL,YAAAA,UAAU,EAAC,EAA7C;AAAiDM,YAAAA,QAAQ,EAAC,EAA1D;AAA8DC,YAAAA,SAAS,EAAC;AAAxE,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAiGnB,KAAK,CAACoB,MAAN,CAAaC,QAA9G,CANJ,CADS;AAAA,OAJK;AAclBC,MAAAA,WAAW,EAAE;AAAA,eACT,oBAAC,IAAD;AAAM,UAAA,KAAK,EAAE;AACTZ,YAAAA,aAAa,EAAE,KADN;AAETa,YAAAA,cAAc,EAAE,eAFP;AAGTC,YAAAA,WAAW,EAAE,EAHJ;AAITC,YAAAA,KAAK,EAAC;AAJG,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAMI,oBAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI,oBAAC,WAAD;AAAa,UAAA,IAAI,EAAC,cAAlB;AAAiC,UAAA,IAAI,EAAE,EAAvC;AAA2C,UAAA,KAAK,EAAC,OAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,CANJ,EASI,oBAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI,oBAAC,QAAD;AAAU,UAAA,IAAI,EAAC,MAAf;AAAsB,UAAA,IAAI,EAAE,EAA5B;AAAgC,UAAA,KAAK,EAAC,OAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,CATJ,CADS;AAAA;AAdK,KAAtB;AA8BH,GA/Bc,EA+BZ,CAAC1B,UAAD,CA/BY,CAAf;;AAiCA,MAAM2B,WAAW,GAAG,SAAdA,WAAc,GAAK;AACrBC,IAAAA,QAAQ,CAACC,OAAT;AACAjC,IAAAA,EAAE,CAACkC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B9B,KAAK,CAACoB,MAAN,CAAaW,EAAxC,EAA4CF,UAA5C,CAAuD,UAAvD,EAAmEG,GAAnE,CAAuE;AACnEC,MAAAA,SAAS,EAAEpC,QAAQ,CAACqC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADwD;AAEnEC,MAAAA,OAAO,EAAEpC,KAF0D;AAGnEqC,MAAAA,WAAW,EAAE1C,IAAI,CAAC2C,WAAL,CAAiBD,WAHqC;AAInEE,MAAAA,KAAK,EAAE5C,IAAI,CAAC2C,WAAL,CAAiBC,KAJ2C;AAKnEzB,MAAAA,QAAQ,EAAEnB,IAAI,CAAC2C,WAAL,CAAiBxB;AALwC,KAAvE;AAOAb,IAAAA,QAAQ,CAAC,EAAD,CAAR;AACH,GAVD;;AAYAd,EAAAA,eAAe,CAAC,YAAM;AAClB,QAAMqD,WAAW,GAAG9C,EAAE,CACrBkC,UADmB,CACR,OADQ,EAEnBC,GAFmB,CAEf9B,KAAK,CAACoB,MAAN,CAAaW,EAFE,EAGnBF,UAHmB,CAGR,UAHQ,EAInBa,OAJmB,CAIX,WAJW,EAIC,MAJD,EAKnBC,UALmB,CAKR,UAACC,QAAD;AAAA,aAAcxC,WAAW,CAC7BwC,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAkB,UAAAhB,GAAG;AAAA,eAAI;AACvBC,UAAAA,EAAE,EAAED,GAAG,CAACC,EADe;AAEvBjB,UAAAA,IAAI,EAAEgB,GAAG,CAAChB,IAAJ;AAFiB,SAAJ;AAAA,OAArB,CAD6B,CAAzB;AAAA,KALQ,CAApB;AAWA,WAAO2B,WAAP;AACH,GAbc,EAaZ,CAACzC,KAAD,CAbY,CAAf;AAeA,SACI,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAE;AAAC+C,MAAAA,IAAI,EAAC,CAAN;AAASC,MAAAA,eAAe,EAAC;AAAzB,KAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,MAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI,oBAAC,oBAAD;AAAsB,IAAA,QAAQ,EAAEC,QAAQ,CAACC,EAAT,KAAgB,KAAhB,GAAwB,SAAxB,GAAkC,QAAlE;AAA4E,IAAA,KAAK,EAAEC,MAAM,CAACC,SAA1F;AAAqG,IAAA,sBAAsB,EAAE,EAA7H;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEI,oBAAC,wBAAD;AAA0B,IAAA,OAAO,EAAEzB,QAAQ,CAACC,OAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA,0CACI,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKzB,QAAQ,CAAC2C,GAAT,CAAa;AAAA,QAAEf,EAAF,SAAEA,EAAF;AAAA,QAAKjB,IAAL,SAAKA,IAAL;AAAA,WACVA,IAAI,CAAC0B,KAAL,KAAe5C,IAAI,CAAC2C,WAAL,CAAiBC,KAAhC,GACE,oBAAC,IAAD;AAAM,MAAA,GAAG,EAAET,EAAX;AAAe,MAAA,KAAK,EAAEoB,MAAM,CAACE,QAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAQ,MAAA,QAAQ,EAAC,UAAjB;AAA4B,MAAA,KAAK,EAAE,CAAC,CAApC;AAAuC,MAAA,MAAM,EAAE,CAAC,EAAhD;AAAoD,MAAA,OAAO,MAA3D;AAA4D,MAAA,IAAI,EAAE,EAAlE;AAAsE,MAAA,MAAM,EAAE;AAACxC,QAAAA,GAAG,EAAEC,IAAI,CAACC;AAAX,OAA9E;AAAqG,MAAA,cAAc,EAAEoC,MAAM,CAACG,cAA5H;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEH,MAAM,CAACI,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAmCzC,IAAI,CAACuB,OAAxC,CAFJ,EAGI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEc,MAAM,CAACK,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAmC1C,IAAI,CAACwB,WAAxC,CAHJ,CADF,GAOI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEa,MAAM,CAACM,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAQ,MAAA,QAAQ,EAAC,UAAjB;AAA4B,MAAA,IAAI,EAAE,CAAC,CAAnC;AAAsC,MAAA,MAAM,EAAE,CAAC,EAA/C;AAAmD,MAAA,OAAO,MAA1D;AAA2D,MAAA,IAAI,EAAE,EAAjE;AAAqE,MAAA,MAAM,EAAE;AAAC5C,QAAAA,GAAG,EAAEC,IAAI,CAACC;AAAX,OAA7E;AAAoG,MAAA,cAAc,EAAEoC,MAAM,CAACO,YAA3H;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEP,MAAM,CAACQ,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAiC7C,IAAI,CAACuB,OAAtC,CAFF,EAGE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEc,MAAM,CAACS,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAiC9C,IAAI,CAACwB,WAAtC,CAHF,CARM;AAAA,GAAb,CADL,CADJ,EAkBI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEa,MAAM,CAACU,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE5D,KAAlB;AAAyB,IAAA,YAAY,EAAE,sBAAC6D,IAAD;AAAA,aAAU5D,QAAQ,CAAC4D,IAAD,CAAlB;AAAA,KAAvC;AAAiE,IAAA,eAAe,EAAGpC,WAAnF;AAAiG,IAAA,WAAW,EAAC,iBAA7G;AAA+H,IAAA,KAAK,EAAEyB,MAAM,CAACY,SAA7I;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI,oBAAC,gBAAD;AAAkB,IAAA,OAAO,EAAErC,WAA3B;AAAwC,IAAA,aAAa,EAAE,GAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,QAAD;AAAU,IAAA,IAAI,EAAC,MAAf;AAAsB,IAAA,IAAI,EAAE,EAA5B;AAAgC,IAAA,KAAK,EAAC,SAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CAFJ,CAlBJ,CADA,CAFJ,CAFJ,CADJ;AAmCH,CAnGD;;AAqGA,eAAe5B,UAAf;AAEA,IAAMqD,MAAM,GAAGa,UAAU,CAACC,MAAX,CAAkB;AAC7Bb,EAAAA,SAAS,EAAC;AACNL,IAAAA,IAAI,EAAC,CADC;AAENmB,IAAAA,SAAS,EAAC;AAFJ,GADmB;AAK7Bb,EAAAA,QAAQ,EAAC;AACLc,IAAAA,OAAO,EAAC,EADH;AAELnB,IAAAA,eAAe,EAAC,SAFX;AAGLoB,IAAAA,SAAS,EAAC,UAHL;AAILC,IAAAA,YAAY,EAAC,EAJR;AAKL7C,IAAAA,WAAW,EAAC,EALP;AAML8C,IAAAA,YAAY,EAAC,EANR;AAOLC,IAAAA,QAAQ,EAAC,KAPJ;AAQLC,IAAAA,QAAQ,EAAC;AARJ,GALoB;AAe7Bf,EAAAA,MAAM,EAAC;AACHU,IAAAA,OAAO,EAAC,EADL;AAEHnB,IAAAA,eAAe,EAAC,SAFb;AAGHoB,IAAAA,SAAS,EAAC,YAHP;AAIHC,IAAAA,YAAY,EAAC,EAJV;AAKHI,IAAAA,MAAM,EAAC,EALJ;AAMHF,IAAAA,QAAQ,EAAC,KANN;AAOHC,IAAAA,QAAQ,EAAC;AAPN,GAfsB;AAwB7BlB,EAAAA,cAAc,EAAC;AACXkB,IAAAA,QAAQ,EAAC,UADE;AAEXE,IAAAA,MAAM,EAAE,CAAC,EAFE;AAGXC,IAAAA,KAAK,EAAC,CAAC;AAHI,GAxBc;AA6B7BjB,EAAAA,YAAY,EAAC;AACTc,IAAAA,QAAQ,EAAC,UADA;AAETE,IAAAA,MAAM,EAAE,CAAC,EAFA;AAGTE,IAAAA,IAAI,EAAC,CAAC;AAHG,GA7BgB;AAkC7BrB,EAAAA,YAAY,EAAC;AACTvC,IAAAA,KAAK,EAAE,OADE;AAETC,IAAAA,UAAU,EAAC,KAFF;AAGTO,IAAAA,WAAW,EAAC,EAHH;AAIT8C,IAAAA,YAAY,EAAC;AAJJ,GAlCgB;AAwC7BX,EAAAA,UAAU,EAAC;AACP3C,IAAAA,KAAK,EAAE,OADA;AAEPC,IAAAA,UAAU,EAAC,KAFJ;AAGPL,IAAAA,UAAU,EAAC,EAHJ;AAIP0D,IAAAA,YAAY,EAAC;AAJN,GAxCkB;AA8C7Bd,EAAAA,YAAY,EAAC;AACTgB,IAAAA,QAAQ,EAAC,UADA;AAETE,IAAAA,MAAM,EAAC,CAFE;AAGTC,IAAAA,KAAK,EAAC,EAHG;AAITzD,IAAAA,QAAQ,EAAC,EAJA;AAKTF,IAAAA,KAAK,EAAC;AALG,GA9CgB;AAqD7B4C,EAAAA,UAAU,EAAC;AACPY,IAAAA,QAAQ,EAAC,UADF;AAEPE,IAAAA,MAAM,EAAC,CAFA;AAGPE,IAAAA,IAAI,EAAC,EAHE;AAIP1D,IAAAA,QAAQ,EAAC,EAJF;AAKPF,IAAAA,KAAK,EAAC;AALC,GArDkB;AA4D7B6C,EAAAA,MAAM,EAAC;AACHnD,IAAAA,aAAa,EAAC,KADX;AAEHC,IAAAA,UAAU,EAAC,QAFR;AAGHc,IAAAA,KAAK,EAAC,MAHH;AAIH0C,IAAAA,OAAO,EAAC;AAJL,GA5DsB;AAkE7BJ,EAAAA,SAAS,EAAC;AACNhB,IAAAA,IAAI,EAAC,CADC;AAEN2B,IAAAA,MAAM,EAAC,CAFD;AAGNG,IAAAA,MAAM,EAAC,EAHD;AAINrD,IAAAA,WAAW,EAAC,EAJN;AAKNsD,IAAAA,WAAW,EAAC,OALN;AAMN9B,IAAAA,eAAe,EAAC,SANV;AAON+B,IAAAA,WAAW,EAAC,CAPN;AAQNZ,IAAAA,OAAO,EAAC,CARF;AASNnD,IAAAA,KAAK,EAAC,OATA;AAUNqD,IAAAA,YAAY,EAAC,EAVP;AAWN5C,IAAAA,KAAK,EAAC;AAXA;AAlEmB,CAAlB,CAAf","sourcesContent":["import React, {useLayoutEffect, useState} from 'react'\r\nimport { StatusBar } from 'expo-status-bar';\r\nimport { StyleSheet, Text, TouchableOpacity, View, SafeAreaView, KeyboardAvoidingView, ScrollView, Platform,  TextInput,Keyboard, TouchableWithoutFeedback } from 'react-native'\r\nimport { Avatar } from 'react-native-elements'\r\nimport { AntDesign, FontAwesome, Ionicons } from '@expo/vector-icons'\r\nimport { db, auth } from '../firebaseConfig';\r\nimport firebase from 'firebase/app';\r\nimport  \"firebase/firestore\";\r\n\r\n\r\nconst ChatScreen = ({navigation, route }) => {\r\n\r\n    const [input, setInput] = useState(\"\");\r\n    const [messages, setMessages] = useState([])\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({\r\n            title: \"Chat\",\r\n            headerBackTitleVisible: false,\r\n            headerTitleAlign: \"left\",\r\n            headerTitle: () => (\r\n                <View style={{\r\n                    flexDirection:\"row\",\r\n                    alignItems:\"center\",\r\n                    marginLeft:-20,\r\n                }}>\r\n                    <Avatar rounded source={{ uri: messages[0]?.data.photoURL }}/>\r\n                    <Text style={{color:\"white\", fontWeight:\"700\", marginLeft:10, fontSize:15, textAlign:'center'}}>{route.params.chatName}</Text>\r\n                </View>\r\n            ),\r\n            headerRight: () => (\r\n                <View style={{\r\n                    flexDirection: \"row\",\r\n                    justifyContent: \"space-between\",\r\n                    marginRight: 20,\r\n                    width:80,\r\n                }}>\r\n                    <TouchableOpacity>\r\n                        <FontAwesome name=\"video-camera\" size={24} color=\"white\"/>\r\n                    </TouchableOpacity>\r\n                    <TouchableOpacity>\r\n                        <Ionicons name=\"call\" size={24} color=\"white\"/>\r\n                    </TouchableOpacity>\r\n                </View>\r\n            )\r\n        })\r\n    }, [navigation]);\r\n\r\n    const sendMessage = () =>{\r\n        Keyboard.dismiss();\r\n        db.collection('chats').doc(route.params.id).collection(\"messages\").add({\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n            message: input,\r\n            displayName: auth.currentUser.displayName,\r\n            email: auth.currentUser.email,\r\n            photoURL: auth.currentUser.photoURL,\r\n        });\r\n        setInput('');\r\n    };\r\n\r\n    useLayoutEffect(() => {\r\n        const unsubscribe = db\r\n        .collection(\"chats\")\r\n        .doc(route.params.id)\r\n        .collection(\"messages\")\r\n        .orderBy(\"timestamp\",\"desc\")\r\n        .onSnapshot((snapshot) => setMessages(\r\n                snapshot.docs.map(doc =>({\r\n                  id: doc.id,\r\n                  data: doc.data(),  \r\n                }))\r\n        ));\r\n        return unsubscribe;\r\n    }, [route]);\r\n\r\n    return (\r\n        <SafeAreaView style={{flex:1, backgroundColor:\"f9f9f9\"}}>\r\n            <StatusBar style=\"dark\" />\r\n            <KeyboardAvoidingView behavior={Platform.OS === \"ios\" ? \"padding\":\"height\"} style={styles.container} keyboardVerticalOffset={90}>\r\n\r\n                <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\r\n                <>\r\n                    <ScrollView>\r\n                        {messages.map(({id,data}) =>(\r\n                            data.email === auth.currentUser.email ? (\r\n                              <View key={id} style={styles.reciever}>\r\n                                  <Avatar position=\"absolute\" right={-5} bottom={-15} rounded size={30} source={{uri: data.photoURL,}} containerStyle={styles.avatarReciever} />\r\n                                  <Text style={styles.recieverText}>{data.message}</Text>\r\n                                  <Text style={styles.recieverName}>{data.displayName}</Text>\r\n                              </View>  \r\n                            ):(\r\n                                <View style={styles.sender}>\r\n                                    <Avatar position=\"absolute\" left={-5} bottom={-15} rounded size={30} source={{uri: data.photoURL,}} containerStyle={styles.avatarSender} />\r\n                                  <Text style={styles.senderText}>{data.message}</Text>\r\n                                  <Text style={styles.senderName}>{data.displayName}</Text>\r\n                                </View>\r\n                            )\r\n                        ))}\r\n                    </ScrollView>\r\n                    <View style={styles.footer}>\r\n                        <TextInput value={input} onChangeText={(text) => setInput(text)} onSubmitEditing={(sendMessage)} placeholder=\"Type Message...\" style={styles.textInput} />\r\n                        <TouchableOpacity onPress={sendMessage} activeOpacity={0.5}>\r\n                            <Ionicons name=\"send\" size={24} color=\"#0b3c6e\"/>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </>\r\n                </TouchableWithoutFeedback>\r\n            </KeyboardAvoidingView>\r\n        </SafeAreaView>\r\n    )\r\n}\r\n\r\nexport default ChatScreen\r\n\r\nconst styles = StyleSheet.create({\r\n    container:{\r\n        flex:1,\r\n        marginTop:5,\r\n    },\r\n    reciever:{\r\n        padding:15,\r\n        backgroundColor:\"#ababab\",\r\n        alignSelf:\"flex-end\",\r\n        borderRadius:20, \r\n        marginRight:15,\r\n        marginBottom:20,\r\n        maxWidth:\"80%\",\r\n        position:\"relative\",\r\n    },\r\n    sender:{\r\n        padding:15,\r\n        backgroundColor:\"#2B68E6\",\r\n        alignSelf:\"flex-start\",\r\n        borderRadius:20, \r\n        margin:15,\r\n        maxWidth:\"80%\",\r\n        position:\"relative\",\r\n    },\r\n    avatarReciever:{\r\n        position:\"absolute\",\r\n        bottom: -15,\r\n        right:-5,\r\n    },\r\n    avatarSender:{\r\n        position:\"absolute\",\r\n        bottom: -15,\r\n        left:-5,\r\n    },\r\n    recieverText:{\r\n        color: \"black\",\r\n        fontWeight:\"400\",\r\n        marginRight:10,\r\n        marginBottom:10,\r\n    },\r\n    senderText:{\r\n        color: \"white\",\r\n        fontWeight:\"400\",\r\n        marginLeft:10,\r\n        marginBottom:10,\r\n    },\r\n    recieverName:{\r\n        position:\"absolute\",\r\n        bottom:2,\r\n        right:27,\r\n        fontSize:10,\r\n        color:\"black\",\r\n    },\r\n    senderName:{\r\n        position:\"absolute\",\r\n        bottom:2,\r\n        left:27,\r\n        fontSize:10,\r\n        color:\"white\",\r\n    },\r\n    footer:{\r\n        flexDirection:\"row\",\r\n        alignItems:\"center\",\r\n        width:\"100%\",\r\n        padding:10,\r\n    },\r\n    textInput:{\r\n        flex:1,\r\n        bottom:0,\r\n        height:40,\r\n        marginRight:10,\r\n        borderColor:\"black\",\r\n        backgroundColor:\"#ECECEC\",\r\n        borderWidth:1,\r\n        padding:5,\r\n        color:\"black\",\r\n        borderRadius:30,\r\n        width:\"100%\",\r\n    },\r\n})\r\n"]},"metadata":{},"sourceType":"module"}